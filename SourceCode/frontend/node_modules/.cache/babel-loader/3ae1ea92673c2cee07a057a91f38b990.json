{"ast":null,"code":"import _objectSpread from \"/var/www/html/midOhio/fresh-trak/sourceCode/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/var/www/html/midOhio/fresh-trak/sourceCode/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/var/www/html/midOhio/fresh-trak/sourceCode/frontend/src/Modules/ModulePermission/ModulePermissionComponent.js\";\n\n/**\n * Created by basil on 20/2/20.\n */\nimport React from 'react';\nimport '../../App.css';\nimport { showMessage } from '../../Utils/Util';\nimport { STATUS_ACTIVE } from '../../Utils/Constants';\nimport { API_URL } from '../../Utils/Urls';\nimport { ajaxPost, ajaxPut } from '../../Services/Http/Ajax';\nimport Checkbox from \"../General/CheckBoxComponent\";\nimport { ToastContainer } from \"react-toastify\";\n\nconst ModulePermissionComponent = props => {\n  const _React$useState = React.useState(false),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        moduleFetched = _React$useState2[0],\n        setModuleFetched = _React$useState2[1];\n\n  const _React$useState3 = React.useState([]),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        modulePermissionArray = _React$useState4[0],\n        setModulePermissionArray = _React$useState4[1];\n\n  const _React$useState5 = React.useState(false),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        isMainModuleActive = _React$useState6[0],\n        setIsMainModuleActive = _React$useState6[1];\n\n  const moduleId = props.moduleId,\n        roleId = props.roleId,\n        agencyId = props.agencyId;\n\n  const usePrevious = value => {\n    const ref = React.useRef();\n    React.useEffect(() => {\n      ref.current = value;\n    });\n    return ref.current;\n  };\n\n  const previousModuleId = usePrevious(moduleId);\n  const previousRoleId = usePrevious(roleId);\n  const previousAgencyId = usePrevious(agencyId);\n\n  const getModulePermissionData = () => {\n    if (roleId && moduleId) {\n      let postData = {\n        data: {\n          roleId: roleId,\n          moduleId: moduleId,\n          agencyId: agencyId\n        }\n      };\n      let uri = API_URL.GET_MODULE_PERMISSION_URL;\n      ajaxPost(uri, postData, getModulePermissionDataSuccess);\n    }\n  };\n\n  const getModulePermissionDataSuccess = response => {\n    if (response.status === STATUS_ACTIVE) {\n      let moduleData;\n      moduleData = response.content;\n      let moduleNewTemp = moduleData.map(item => {\n        return _objectSpread({}, item, {\n          is_active: item.permission_is_active === 1\n        });\n      });\n      setModulePermissionArray(moduleNewTemp);\n      setModuleFetched(true);\n      setIsMainModuleActive(moduleNewTemp[0].is_active);\n    }\n  };\n\n  const moduleCheckBoxDisabled = e => {\n    setIsMainModuleActive(e.target.checked);\n  };\n\n  const handleChange = e => {\n    const item = parseInt(e.target.id);\n    setModulePermissionArray(modulePermissionArray.map(elem => {\n      let tempData = elem;\n\n      if (tempData.permission_id === item) {\n        tempData.is_active = e.target.checked;\n      }\n\n      return tempData;\n    }));\n    putModulePermissionData(e);\n  };\n\n  React.useEffect(() => {\n    if (previousModuleId !== moduleId || previousRoleId !== roleId || previousAgencyId !== agencyId) {\n      getModulePermissionData();\n    }\n  }, [moduleId, roleId, agencyId]);\n\n  const putModulePermissionData = event => {\n    let data = {\n      data: {\n        module_id: props.moduleId,\n        is_active: event.target.checked,\n        role_id: props.roleId,\n        permission_id: event.target.id,\n        agency_id: props.agencyId,\n        role_permission_id: event.target.getAttribute(\"dataid\")\n      }\n    };\n    let uri = API_URL.PUT_MODULE_PERMISSION_URL;\n    ajaxPut(uri, data, response => {\n      if (response.status === STATUS_ACTIVE) {\n        showMessage('success', response.message);\n      }\n    });\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(ToastContainer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"data-bind-role\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, moduleFetched && React.createElement(\"div\", {\n    className: \"data-bind-role\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: \"btn text-info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, console.log(modulePermissionArray, 'module 3'), \" \", modulePermissionArray[0].module_name, \" \", React.createElement(\"input\", {\n    onChange: moduleCheckBoxDisabled,\n    checked: isMainModuleActive,\n    type: \"checkBox\",\n    name: \"menuPermission\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, modulePermissionArray.map((value, index) => {\n    return React.createElement(\"div\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"permission-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, value.permission_name, \" \"), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, \" \", React.createElement(Checkbox, {\n      name: `permission-${value.permission_id}`,\n      dataid: value.role_permission_id,\n      id: value.permission_id,\n      checked: value.is_active,\n      disabled: !isMainModuleActive,\n      onChangeFunction: handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }))));\n  })))));\n};\n\nexport default ModulePermissionComponent;","map":{"version":3,"sources":["/var/www/html/midOhio/fresh-trak/sourceCode/frontend/src/Modules/ModulePermission/ModulePermissionComponent.js"],"names":["React","showMessage","STATUS_ACTIVE","API_URL","ajaxPost","ajaxPut","Checkbox","ToastContainer","ModulePermissionComponent","props","useState","moduleFetched","setModuleFetched","modulePermissionArray","setModulePermissionArray","isMainModuleActive","setIsMainModuleActive","moduleId","roleId","agencyId","usePrevious","value","ref","useRef","useEffect","current","previousModuleId","previousRoleId","previousAgencyId","getModulePermissionData","postData","data","uri","GET_MODULE_PERMISSION_URL","getModulePermissionDataSuccess","response","status","moduleData","content","moduleNewTemp","map","item","is_active","permission_is_active","moduleCheckBoxDisabled","e","target","checked","handleChange","parseInt","id","elem","tempData","permission_id","putModulePermissionData","event","module_id","role_id","agency_id","role_permission_id","getAttribute","PUT_MODULE_PERMISSION_URL","message","console","log","module_name","index","permission_name"],"mappings":"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","sourcesContent":["/**\n * Created by basil on 20/2/20.\n */\n\nimport React from 'react';\nimport '../../App.css';\nimport {showMessage} from '../../Utils/Util';\nimport {STATUS_ACTIVE} from '../../Utils/Constants';\nimport {API_URL} from '../../Utils/Urls';\nimport {ajaxPost,ajaxPut} from '../../Services/Http/Ajax';\nimport Checkbox from \"../General/CheckBoxComponent\";\nimport {ToastContainer} from \"react-toastify\";\n\nconst ModulePermissionComponent = (props) => {\n\n    const [moduleFetched, setModuleFetched] = React.useState(false);\n    const [modulePermissionArray, setModulePermissionArray] = React.useState([]);\n    const [isMainModuleActive, setIsMainModuleActive] = React.useState(false);\n    const {moduleId, roleId,agencyId } = props;\n\n    const usePrevious = (value) => {\n        const ref = React.useRef();\n        React.useEffect(() => {\n            ref.current = value;\n        });\n        return ref.current;\n    };\n\n    const previousModuleId = usePrevious(moduleId);\n    const previousRoleId = usePrevious(roleId);\n    const previousAgencyId = usePrevious(agencyId);\n\n    const getModulePermissionData = () => {\n        if (roleId && moduleId) {\n            let postData = {\n                data:{\n                    roleId: roleId,\n                    moduleId: moduleId,\n                    agencyId:agencyId\n                }\n            };\n            let uri = API_URL.GET_MODULE_PERMISSION_URL;\n          ajaxPost(uri, postData, getModulePermissionDataSuccess)\n        }\n    };\n\n    const getModulePermissionDataSuccess = (response) => {\n        if (response.status === STATUS_ACTIVE) {\n            let moduleData;\n            moduleData = response.content;\n            let moduleNewTemp = moduleData.map((item)=> { return {...item, is_active: item.permission_is_active === 1}} );\n            setModulePermissionArray(moduleNewTemp);\n            setModuleFetched(true);\n            setIsMainModuleActive(moduleNewTemp[0].is_active);\n        }\n    };\n\n    const moduleCheckBoxDisabled = (e) => {\n        setIsMainModuleActive(e.target.checked);\n    };\n\n    const handleChange = (e) => {\n        const item = parseInt(e.target.id);\n        setModulePermissionArray(modulePermissionArray.map((elem)=>{\n            let tempData = elem;\n            if(tempData.permission_id === item){\n                tempData.is_active = e.target.checked;\n            }\n            return tempData;\n        }));\n         putModulePermissionData(e);\n    };\n\n    React.useEffect(() => {\n        if(previousModuleId !== moduleId || previousRoleId !== roleId || previousAgencyId !== agencyId) {\n            getModulePermissionData();\n        }\n    }, [moduleId, roleId,agencyId]);\n\n    const putModulePermissionData = (event) => {\n        let data = {\n            data: {\n                module_id : props.moduleId,\n                is_active : event.target.checked,\n                role_id : props.roleId,\n                permission_id : event.target.id,\n                agency_id :props.agencyId,\n                role_permission_id :  event.target.getAttribute(\"dataid\")\n            }\n        };\n        let uri = API_URL.PUT_MODULE_PERMISSION_URL;\n        ajaxPut(uri, data, (response) => {\n            if (response.status === STATUS_ACTIVE) {\n                showMessage('success', response.message)\n            }\n        });\n    };\n\n    return (\n        <div>\n            <ToastContainer/>\n            <div className=\"data-bind-role\">\n                {\n                    moduleFetched && (\n                        <div className=\"data-bind-role\">\n                            <span className=\"btn text-info\">{console.log(modulePermissionArray,'module 3')} {modulePermissionArray[0].module_name} <input onChange={moduleCheckBoxDisabled} checked={isMainModuleActive} type=\"checkBox\" name=\"menuPermission\"/></span>\n                            <div>\n                                { modulePermissionArray.map( (value, index) => {\n                                    return <div key={index}>\n                                        <div className=\"permission-container\">\n                                            <div>{value.permission_name} </div>\n                                            <div> <Checkbox name={`permission-${value.permission_id}`} dataid={value.role_permission_id} id={value.permission_id} checked={value.is_active} disabled = {!isMainModuleActive} onChangeFunction={handleChange} /></div>\n                                        </div>\n                                    </div>\n                                })\n                                }\n                            </div>\n                        </div>\n                    )}\n            </div>\n        </div>\n    )\n};\n\nexport default ModulePermissionComponent;"]},"metadata":{},"sourceType":"module"}